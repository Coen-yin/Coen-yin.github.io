<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Code Block Sorting Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-result {
            border: 2px solid;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .success {
            border-color: #28a745;
            background: #d4edda;
            color: #155724;
        }
        .error {
            border-color: #dc3545;
            background: #f8d7da;
            color: #721c24;
        }
        .test-input {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>Code Block Sorting Test</h1>
    
    <div class="test-section">
        <h2>Test 1: Basic HTML/CSS/JS Website</h2>
        <div class="test-input">```html
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;My Website&lt;/title&gt;
    &lt;link rel="stylesheet" href="styles.css"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Hello World&lt;/h1&gt;
    &lt;script src="script.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
```

```css
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
}

h1 {
    color: #333;
    text-align: center;
}
```

```javascript
document.addEventListener('DOMContentLoaded', function() {
    console.log('Website loaded!');
    
    const heading = document.querySelector('h1');
    heading.addEventListener('click', function() {
        alert('Hello from JavaScript!');
    });
});
```</div>
        <div id="test1-result" class="test-result">Testing...</div>
    </div>
    
    <div class="test-section">
        <h2>Test 2: Python Multiple Files</h2>
        <div class="test-input">```python
# main.py
from calculator import Calculator
from utils import print_welcome

def main():
    print_welcome()
    calc = Calculator()
    result = calc.add(5, 3)
    print(f"5 + 3 = {result}")

if __name__ == "__main__":
    main()
```

```python
# calculator.py
class Calculator:
    def add(self, a, b):
        return a + b
    
    def subtract(self, a, b):
        return a - b
    
    def multiply(self, a, b):
        return a * b
    
    def divide(self, a, b):
        if b != 0:
            return a / b
        else:
            raise ValueError("Cannot divide by zero")
```

```python
# utils.py
def print_welcome():
    print("Welcome to the Calculator App!")
    print("=" * 30)
```</div>
        <div id="test2-result" class="test-result">Testing...</div>
    </div>
    
    <div class="test-section">
        <h2>Test 3: Mixed Languages (Should Sort by Priority)</h2>
        <div class="test-input">```python
# Python code should come after web languages
print("Hello from Python!")
```

```html
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;&lt;title&gt;Test&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;&lt;h1&gt;HTML Test&lt;/h1&gt;&lt;/body&gt;
&lt;/html&gt;
```

```css
body { background: #f0f0f0; }
```

```javascript
console.log("JavaScript test");
```</div>
        <div id="test3-result" class="test-result">Testing...</div>
    </div>

    <script>
        // Test the code block processing functions
        
        // Mock functions from the main script
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        function getLanguageInfo(language) {
            const langMap = {
                'html': { name: 'HTML', icon: 'fab fa-html5', color: '#e34c26' },
                'css': { name: 'CSS', icon: 'fab fa-css3-alt', color: '#1572b6' },
                'javascript': { name: 'JavaScript', icon: 'fab fa-js-square', color: '#f7df1e' },
                'python': { name: 'Python', icon: 'fab fa-python', color: '#3776ab' },
                'text': { name: 'Text', icon: 'fas fa-file-alt', color: '#6c757d' }
            };
            return langMap[language] || langMap['text'];
        }
        
        function getFileExtension(language) {
            const extensionMap = {
                'html': '.html',
                'css': '.css',
                'javascript': '.js',
                'python': '.py',
                'text': '.txt'
            };
            return extensionMap[language] || '.txt';
        }
        
        // Test function to check if web project organization works
        function testCodeBlockProcessing() {
            // Test 1: Web project detection
            const test1Input = document.querySelector('#test1-result').previousElementSibling.textContent;
            const codeBlockPattern = /```(\w*)\n?([\s\S]*?)```/g;
            const codeBlocks1 = [];
            let match;
            
            while ((match = codeBlockPattern.exec(test1Input)) !== null) {
                codeBlocks1.push({
                    language: match[1] || '',
                    code: match[2].trim()
                });
            }
            
            // Check if we detected HTML, CSS, JS
            const languages1 = codeBlocks1.map(b => b.language.toLowerCase());
            const hasWebLanguages = languages1.includes('html') && 
                                   languages1.includes('css') && 
                                   languages1.includes('javascript');
            
            const test1Result = document.getElementById('test1-result');
            if (hasWebLanguages && codeBlocks1.length === 3) {
                test1Result.className = 'test-result success';
                test1Result.textContent = '✅ SUCCESS: Detected 3 web languages (HTML, CSS, JavaScript) - should be organized as web project';
            } else {
                test1Result.className = 'test-result error';
                test1Result.textContent = `❌ FAILED: Expected 3 web languages, got: ${languages1.join(', ')}`;
            }
            
            // Test 2: Python multiple files
            const test2Input = document.querySelector('#test2-result').previousElementSibling.textContent;
            const codeBlocks2 = [];
            codeBlockPattern.lastIndex = 0;
            
            while ((match = codeBlockPattern.exec(test2Input)) !== null) {
                codeBlocks2.push({
                    language: match[1] || '',
                    code: match[2].trim()
                });
            }
            
            const test2Result = document.getElementById('test2-result');
            if (codeBlocks2.length === 3 && codeBlocks2.every(b => b.language === 'python')) {
                test2Result.className = 'test-result success';
                test2Result.textContent = '✅ SUCCESS: Detected 3 Python code blocks - should be sorted individually';
            } else {
                test2Result.className = 'test-result error';
                test2Result.textContent = `❌ FAILED: Expected 3 Python blocks, got: ${codeBlocks2.map(b => b.language).join(', ')}`;
            }
            
            // Test 3: Mixed languages priority sorting
            const test3Input = document.querySelector('#test3-result').previousElementSibling.textContent;
            const codeBlocks3 = [];
            codeBlockPattern.lastIndex = 0;
            
            while ((match = codeBlockPattern.exec(test3Input)) !== null) {
                codeBlocks3.push({
                    language: match[1] || '',
                    code: match[2].trim()
                });
            }
            
            const test3Result = document.getElementById('test3-result');
            const originalOrder = codeBlocks3.map(b => b.language);
            const expectedOrder = ['html', 'css', 'javascript', 'python']; // Based on priority
            
            if (originalOrder.length === 4) {
                test3Result.className = 'test-result success';
                test3Result.textContent = `✅ SUCCESS: Detected mixed languages [${originalOrder.join(', ')}] - should be sorted by priority to [${expectedOrder.join(', ')}]`;
            } else {
                test3Result.className = 'test-result error';
                test3Result.textContent = `❌ FAILED: Expected 4 languages, got: ${originalOrder.join(', ')}`;
            }
        }
        
        // Run tests when page loads
        document.addEventListener('DOMContentLoaded', testCodeBlockProcessing);
    </script>
</body>
</html>